# Use a CFD to experiment with WIP limits and manage the flow

This may seem a little abstract. It’s helpful to think about how you’d apply a CFD to a very simple system that most of us are familiar with: a doctor’s office. Let’s say that you had to visit a particular doctor several times to get a series of tests and discuss the results. You notice that if you have an appointment with the doctor in the morning after the office first opens, you don’t have to wait very long. But if your appointment is later in the day, you have to sit in the waiting room for a long time—and the later the appointment, the longer the wait. Clearly this system is not stable. How would you use a CFD to stabilize it?

The first step would be to visualize the workflow. Let’s say that every patient starts out by taking a seat in the waiting room. Eventually, a nurse calls the patient back to one of the exam rooms, where she gets weighed and has her blood pressure and tempera‐ ture taken. Then she waits for the doctor to see her. In this office, there are five exam rooms and two doctors, and they’re almost always occupied. More importantly, that means there can never be more than five patients in the exam rooms, or two patients seeing doctors. Those are WIP limits, imposed by the real-life constraints of the system.

These doctors don’t like the fact that their patients later in the day always complain of long wait times. What’s worse, they feel more and more rushed to get the patients out of the office at the end of the day, and they’re worried that they may not always be making the best medical decisions because they’re under pressure to move patients through the office as fast as they can. Can Kanban help these doctors reduce their patients’ waiting time and provide better care?

Let’s find out. We’ll start by building a CFD for a typical day. We’ll have the office staff count the number of patients who walk into the office every 15 minutes. This gives us an arrival rate—literally the number of patients who arrived in the office. And we can count the inventory for each 15-minute interval by counting the total number of patients in the waiting room and the five exam rooms. Every time someone arrives, they’ll add a sticky to the first column on the kanban board. When a patient moves from the waiting room to an exam room, they’ll move the sticky to the second col‐ umn. And when the doctor sees the patient, they’ll move the sticky to the third col‐ umn. Once the doctor is done with the patient, the sticky comes off the board. The office staff can record the counts of the stickies in the columns for every 15-minute interval.

Now they have all of the data that they need in order to build a CFD.

This system isn’t stable yet. The arrival rate is stable, because the office staff books patient appointments so that they arrive at a constant rate. They don’t want to stay late, so they stop booking appointments at 4 p.m. People do run late for their appoint‐ ments, but the trend for the arrival rate is flat so this must be pretty constant through‐ out the day.

The trend for the inventory, however, is not flat. It’s tilted upward, because the inven‐ tory keeps growing and growing. This makes sense; the number of patients in the waiting room also grows throughout the day. So how can the office staff use this new information to improve patient care and reduce waiting times?

The first thing they need to do is stabilize the system—and the tool we have for that is setting a WIP limit. They’ll use the Kanban practice of evolving collaboratively and improving experimentally by deciding on a WIP limit together, and using that as a starting point. After looking at the data, everyone decides to add a WIP limit of six to the waiting room. But there’s a tough decision that needs to be made: the doctors have to agree that if there are already six patients in the waiting room, then the office staff must start calling low-priority patients scheduled for the next hour and ask to reschedule their appointments (but they will find a way to handle more serious cases without compromising patient care). They’ll also ask patients in the waiting room if anyone would be willing to volunteer to reschedule their appointment—and they promise to give that patient priority for the rescheduled appointment. This is a new policy that they need to make explicit. They’ll do that by adding a WIP limit to the kanban board, and also posting a big notice to patients on a piece of paper at the front desk letting them know that this is the policy going forward.

It takes a little practice, but after a few days the office staff gets used to the new policy. They discover that they need to take the patient’s complaint into account. They decide to do this by defining the class of service: they’ll use a pink sticky to indicate patients who have a more severe condition and cannot be rescheduled, and keep the yellow stickies to indicate patients who have more minor problems. This allows them to pro‐ vide more prompt service for patients who need it the most.
And it works! The office staff discovers that once they impose the WIP limit, they no longer have to stop scheduling appointments at 4 p.m. in order to be done by 6 p.m. —they can schedule patients as late as 5:40 p.m. as long as they never schedule patients with more severe problems later than 4:40 p.m. (and they write down this policy as well). Obviously, if someone has a very severe problem and walks into the office, the doctor will see that patient (or send them to the emergency room)—but that’s a rare exception, and because the office staff are smart and responsible, they can handle situations like that on a case-by-case basis. The patients seem much happier because they’re not waiting as long to see the doctor.

## Little’s Law Lets You Control the Flow Through a System

The office staff took the Kanban practice of improving experimentally very seriously. And through their experiments, they discovered something interesting: once they found a good WIP limit, they could control how long patients had to wait. If they scheduled more appointments every hour, there would be four or five patients in the waiting room, and patients would have to wait longer. If they scheduled fewer appointments every hour, there would only be two or three patients waiting to see the doctor, and they would wait less time. This gave them a feeling that for the first time, they were really in control of a system that had caused them so many headaches in the past.

So what’s going on here?

What the office staff discovered is that in a stable system, there’s a relationship between inventory, lead time, and arrival rate. For example, if the office staff sched‐ ules 11 patients to arrive every hour (so the arrival rate λ is 11/hour), and the office has average inventory of seven patients over the course of the day (so the inventory L is 7), then Little’s Law tells us the average time patients have to wait:

W = L ÷ λ = 7 patients ÷ (11 per hour) = .63 hours = 37 minutes

But what if after some experimentation, they discover that scheduling 10 patients to arrive every hour causes the average inventory to drop to 4 patients? There are going to be peak times during the day when all of the exam rooms are filled, but most of the time there’s one patient in the waiting room, one patient in an exam room waiting to see a doctor, and two patients in exam rooms talking to the doctors:

W = 4 patients ÷ (10 patients per hour) = .4 hours = 24 minutes

By using a kanban board and a CFD and experimenting with WIP limits, the office staff discovered that they could reduce the patient waiting time by almost 15 minutes just by scheduling one fewer patient per hour.

This works because Little’s Law tells us that lead time in a stable system is affected by exactly two things, inventory and arrival rate—and WIP limits let you control one of those things. When you add WIP limits to your kanban board, you can reduce unevenness, which keeps inventory from piling up. That gives you a straightforward way to reduce lead time: by reducing the arrival rate (for example, by keeping work in a backlog until the team has time to deal with it, just like Scrum teams do—or by reducing the number of patients scheduled per hour).

This is why the office staff can use Little’s Law to calculate the average lead time. But even if they never calculate it, they’re still affected by it. The reason is that Little’s Law always applies to every stable system, whether or not the team is aware of it. This affects your projects because it isn’t just theory. It’s a proven mathematical law that applies to any system with a stable long-term inventory.
